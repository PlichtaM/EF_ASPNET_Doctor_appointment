@model List<WebApplication2.Models.Appointment>

<h2>Calendar</h2>

@using (Html.BeginForm("BookAppointment", "Appointment", FormMethod.Post))
{
    @Html.AntiForgeryToken()

    <div class="form-group">
        @Html.Label("Specialization:")
        @Html.DropDownList("Specialization", new SelectList(Model.Select(a => a.DoctorSpecialization).Distinct()), "-- Select Specialization --", new { @class = "form-control" })
    </div>

    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Sunday</th>
                <th>Monday</th>
                <th>Tuesday</th>
                <th>Wednesday</th>
                <th>Thursday</th>
                <th>Friday</th>
                <th>Saturday</th>
            </tr>
        </thead>
        <tbody>
            @for (int week = 0; week < 5; week++)
            {
                <tr>
                    @for (int day = 0; day < 7; day++)
                    {
                        var date = DateTime.Today.AddDays(week * 7 + day);
                        var appointments = Model.Where(a => a.Date == date).ToList();
                        var selectedAppointment = appointments.FirstOrDefault(a => a.UserId == null);

                        <td>
                            @if (selectedAppointment != null)
                            {
                                <input type="radio" name="AppointmentId" value="@selectedAppointment.Id" /> @selectedAppointment.Time
                            }
                            else
                            {
                                <span class="text-danger">No available appointments</span>
                            }
                        </td>
                    }
                </tr>
            }
        </tbody>
    </table>

    <button type="submit" class="btn btn-primary">Book Appointment</button>
}

@Html.ActionLink("Back to Profile", "Profile", "Account")
